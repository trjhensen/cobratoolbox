<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>Quadruple precision Flux Balance Analysis</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S3 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.eoOutputWrapper { width: calc(90vw - 10px) !important; }
.S6 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px 4px 0px 0px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { color: rgb(33, 33, 33); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsErrorElement .diagnosticMessage-errorType {    overflow: auto;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent button {    user-select: none;    -webkit-user-select: none;}
.embeddedOutputsErrorElement .eoOutputContent ::selection {}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsWarningElement .diagnosticMessage-warningType {    overflow: auto;}
.embeddedOutputsWarningElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsWarningElement .eoOutputContent ::selection {}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2023 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: var(--mw-color-matlabWarning) !important;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: var(--mw-color-matlabErrors) !important;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: pre;    word-wrap:  initial;    min-height: 18px;    max-height: 550px;}
.embeddedOutputsTextElement .textElement,.embeddedOutputsVariableStringElement .textElement {    overflow: auto;}
.embeddedOutputsTextElement.activeOutput .eoOutputContent,.embeddedOutputsVariableStringElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
/*embeddedOutputsTextElement has a different dom structure than embeddedOutputsVariableStringElement.Unlike variableString, the text output has both TEXT nodes and elements as children. Hence we needa selector for each.*/.embeddedOutputsTextElement .eoOutputContent::selection,.embeddedOutputsTextElement .eoOutputContent ::selection,.embeddedOutputsVariableStringElement .eoOutputContent ::selection {}
.textElement,.rtcDataTipElement .textElement {    padding-top: 2px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.embeddedOutputsMatrixElement,.eoOutputWrapper .matrixElement {    min-height: 18px;    box-sizing: border-box;}
.embeddedOutputsMatrixElement .matrixElement,.eoOutputWrapper  .matrixElement,.rtcDataTipElement .matrixElement {    position: relative;}
.matrixElement .variableValue,.rtcDataTipElement .matrixElement .variableValue {    white-space: pre;    display: inline-block;    vertical-align: top;    overflow: hidden;}
.embeddedOutputsMatrixElement.inlineElement {}
.embeddedOutputsMatrixElement.inlineElement .topHeaderWrapper {    display: none;}
.embeddedOutputsMatrixElement.inlineElement .veTable .body {    padding-top: 0 !important;    max-height: 100px;}
.inlineElement .matrixElement {    max-height: 300px;}
.embeddedOutputsMatrixElement.rightPaneElement {}
.rightPaneElement .matrixElement,.rtcDataTipElement .matrixElement {    overflow: hidden;    padding-left: 9px;}
.rightPaneElement .matrixElement {    margin-bottom: -1px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer,.eoOutputWrapper .matrixElement .valueContainer,.rtcDataTipElement .matrixElement .valueContainer {    white-space: nowrap;    margin-bottom: 3px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis.hide,.embeddedOutputsMatrixElement .matrixElement .verticalEllipsis.hide,.eoOutputWrapper .matrixElement .valueContainer .horizontalEllipsis.hide,.eoOutputWrapper .matrixElement .verticalEllipsis.hide,.rtcDataTipElement .matrixElement .valueContainer .horizontalEllipsis.hide,.rtcDataTipElement .matrixElement .verticalEllipsis.hide {    display: none;}
.embeddedOutputsVariableMatrixElement .matrixElement .valueContainer.hideEllipses .verticalEllipsis, .embeddedOutputsVariableMatrixElement .matrixElement .valueContainer.hideEllipses .horizontalEllipsis {    display:none;}
.eoOutputWrapper .embeddedOutputsVariableMatrixElement .matrixElement .valueContainer {    cursor: default !important;}
.embeddedOutputsVariableElement {    white-space: pre-wrap;    word-wrap: break-word;    min-height: 18px;    max-height: 250px;    overflow: auto;}
.eoOutputWrapper .variableElement {    padding-top: 2px;}
.embeddedOutputsVariableElement.inlineElement {}
.inlineElement .variableElement {}
.embeddedOutputsVariableElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .variableElement {    padding-left: 9px;}
.outputsOnRight .embeddedOutputsVariableElement.rightPaneElement .eoOutputContent {    /* Remove extra space allocated for navigation border */    margin-top: 0;    margin-bottom: 0;}
.variableNameElement {    margin-bottom: 3px;    display: inline-block;}
/* * Ellipses as base64 for HTML export. */.matrixElement .horizontalEllipsis,.rtcDataTipElement .matrixElement .horizontalEllipsis {    display: inline-block;    margin-top: 3px;    /* base64 encoded version of images-liveeditor/HEllipsis.png */    width: 30px;    height: 12px;    background-repeat: no-repeat;    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAJCAYAAADO1CeCAAAAJUlEQVR42mP4//8/A70xw0i29BUDFPxnAEtTW37wWDqakIa4pQDvOOG89lHX2gAAAABJRU5ErkJggg==");}
.matrixElement .verticalEllipsis,.textElement .verticalEllipsis,.rtcDataTipElement .matrixElement .verticalEllipsis,.rtcDataTipElement .textElement .verticalEllipsis {    margin-left: 35px;    /* base64 encoded version of images-liveeditor/VEllipsis.png */    width: 12px;    height: 30px;    background-repeat: no-repeat;    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAZCAYAAAAIcL+IAAAALklEQVR42mP4//8/AzGYgWyFMECMwv8QddRS+P//KyimlmcGUOFoOI6GI/UVAgDnd8Dd4+NCwgAAAABJRU5ErkJggg==");}
.S9 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'T_4CE2BBD0' ><span>Quadruple precision Flux Balance Analysis</span></h1><h2  class = 'S1' id = 'H_8C6952DD' ><span>Author(s): Ronan M.T. Fleming,, Leiden University</span></h2><h2  class = 'S1' id = 'H_13B2214D' ><span>Reviewer(s):</span></h2><h2  class = 'S1' id = 'H_BBAA3A65' ><span>INTRODUCTION</span></h2><div  class = 'S2'><span>In this tutorial, Flux Balance Analysis (FBA) is introduced using the E. coli core model, with functions in the COBRA Toolbox v3.0 [2].  </span></div><div  class = 'S2'><span>Flux balance analysis is a solution to the optimisation problem</span></div><div  class = 'S2'><span texencoding="
\begin{array}{ll}
\textrm{max} &amp; c^{T}v\\
\text{s.t.} &amp; Sv=b\\
 &amp; l\leq v\leq u
\end{array}
\end{equation}" style="vertical-align:-27px"><img src="data:image/png;base64,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" width="96.5" height="65" /></span></div><div  class = 'S2'><span>where </span><span style="font-family: STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">c</span><span> is a vector of linear objective coefficients, </span><span style="font-family: STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">S</span><span> is an m times n matrix of stoichiometric coefficients for m molecular species involved in n reactions. </span><span mathmlencoding="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot;&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;l&lt;/mi&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;and&lt;/mi&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;u&lt;/mi&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;/mrow&gt;&lt;/math&gt;" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="45.5" height="18" /></span><span>are n times 1 vectors that are the lower and upper bounds on the n times 1 variable vector </span><span mathmlencoding="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot;&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;v&lt;/mi&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;/mrow&gt;&lt;/math&gt;" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAkCAYAAAB8DZEQAAAAAXNSR0IArs4c6QAAAddJREFUSEvt1bGL1FAQBvAZZxPwQMXSZRPmwcEhNirXiVaChWihIGclIleKhQiChR4I1yl2Fvba2Il/gOAVolY2KjKTze42clZ3qLsvGQncQTx0d5OVwyJp8973430vQxB24cFdMKBBKrXc1NXUVamBSoubr2vmuoIoihaIaBEADqjqo52JzrlLeZ7PZ1n2sNfrfZ8k/nYncRwfIaLLZnYBEQ8DwE8R2Q8Aw1IQMvMGIs6Z2T1VXamEbC9ut9tRGIaCiJRl2WK3231XDnLO3QeAO2b2UlXP1kKKTcz8HhGPAcCyiDz5Q2UfzeyZqt6tjTjniuBrAPBARG7uCAqdc1+998fTNP1SG2Hm24i4CgAvRORcOYiZrwLAUVW9MQko3v91GJl5CRGfAsAnEVkohYXMvDYajc70+/31mZAoik62Wq1XALAhIvu2w5h51czeJknyfBpg7Ek6nc58EASfi0VmtldVf8RxfIKIlkTk+rTAWCSO44NE9G0LOZTn+RwRPTaz8wX4T5DivpjZI+Ie7/0pIloZDodXBoNBWgUYe5KtWdksJru4fO/9xTRNP1QFpkHWETEAgNMi8qYOMA3y2sxuJUmyVheYiMwSXN7b/BkrNdnU9f/V9Qu7u6olQPsnEAAAAABJRU5ErkJggg==" width="12.5" height="18" /></span><span>of reaction rates (fluxes). The optimal objective value is </span><span texencoding="c^{T}v^{\star}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="30.5" height="20" /></span><span>  is always unique, but the optimal vector </span><span texencoding="v^{\star}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAoCAYAAACb3CikAAAAAXNSR0IArs4c6QAAAxxJREFUWEftlktoFEEQhqu2dwcMPtDgwX3MVkMgihCiCAqiiIgKoqKCxJNK8KKECKIoHjT4RlA86cGjoAh6EBEFQVHMQaInLz6S7tmZ5KIRBEXdeZRMyMK67O4MspsE3Ia5TFfX//FXdc0gzJCFM4QDWiCVlWg58n86ks/npWVZKs7NbGqPSCnPKaVOTjsIEQ0nEonlIyMj36JgmuZIJpNpNwzjSxAE6y3LejZtIFLKjQDwBACOKaUuTwkIEa1DxEMA8BMAbGa2AWAlIu5j5mfMfAsRc+HDzAsB4LbW+i4ABCXAhpVmshQXmbkXEavmZebHnuf1OY7zqelzhIhWAcB1ROwuE7ODIDhsWdb9WiVqmCPlAkR0HhFPlN4x8wOt9fZ6fdJwkHQ63WYYho2IswHgDAD0M3O753mdjuN8nDJH8vn8wUQiccn3/R2FQuEpES1GxPD2PFRKhQ1ddVVzJJXL5TqFECsAYJ7W+lrlSSnl7iAIOnzfv+o4TnhTSitBRC993++3bXuo9DKTyWQNw7jvuu5mx3G+ViP5C8Q0zaVCiD3MvBMRlwDAb6XUXAAolh1GIvqOiG3MfFprPVDak1J2ua77s1oJstnsgmQy2aW1fh4JUgpIp9M5wzAUIgrf91cUCoU35YellGcB4CQzP9Jab4kaVnH2azYrEb1FxGUAcEApdbNKed4z8x2t9ak4QlExNUGklKF4LwBcUUodqUhkSCk/e5633Lbt4SiROPv1HDmOiBcmu31rxZzYDwDdWuv+OCJxYuqB9CDibQD4oJTqLEtmENGg67qbRkdHx+OIxImpCZLL5dYkk8kXAPBdKTWnlIyILjDzkGVZ9+IIxI2pCZLNZjtSqdTEJGTmWVrrX6ZprhZC9Cil+uIKxI2rCWKa5nwhxMTwYeZFQRC0CSFuMPO2ECquQNy4et+acHB5iJjwPG+tEGKgWCzuHRsbC/81Gr7qfvSI6Ec4QcOG9Txvl23b7xpOMJkwCmQcEVMAsEEp9bpZEGHeKJBXzHzUsqzBZkJEgjRbvDx/w3+M/hW+BVLpXMuRliNRt+kPQ+swOCNmKT0AAAAASUVORK5CYII=" width="17" height="20" /></span><span> is usually not unique.</span></div><div  class = 'S2'><span>In summary, the data is {c,S,l,u} and the variable being optimised is v.</span></div><h2  class = 'S1' id = 'H_4EC8492F' ><span>TIMING</span></h2><div  class = 'S2'><span style=' font-style: italic;'>&lt; 1 hrs</span></div><h2  class = 'S1' id = 'H_7E2A567B' ><span>MATERIALS - EQUIPMENT SETUP</span></h2><div  class = 'S2'><span>Please ensure that all the required dependencies (e.g. , </span><span style=' font-family: monospace;'>git</span><span> and </span><span style=' font-family: monospace;'>curl</span><span>) of The COBRA Toolbox have been properly installed by following the installation guide </span><a href = "https://opencobra.github.io/cobratoolbox/stable/installation.html"><span>here</span></a><span>. Please ensure that the COBRA Toolbox has been initialised (tutorial_initialize.mlx) and verify that the pre-packaged LP and QP solvers are functional (tutorial_verify.mlx).</span></div><h2  class = 'S1' id = 'H_B642E8E4' ><span>PROCEDURE</span></h2><h2  class = 'S1' id = 'H_ED106D18' ><span>Load a multiscale model</span></h2><div  class = 'S2'><span>To load a model from a MAT-file, you can simply use the filename (with or without file extension). </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #0e00ff;">if </span><span >~exist(</span><span style="color: #a709f5;">'model'</span><span >,</span><span style="color: #a709f5;">'var'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    load </span><span style="color: #a709f5;">ME_matrix_GlcAer_WT.mat</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    model = modelGlcOAer_WT;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    clear </span><span style="color: #a709f5;">modelGlcOAer_WT</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><h2  class = 'S1'><span style=' font-style: italic;'>Check the scaling properties of a stoichiometric matrix</span></h2><div  class = 'S2'><span>The scaling properties of the stoichiometric matrix using:</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >[precisionEstimate, solverRecommendation] = checkScaling(model);</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement scrollableOutput" uid="321F899E" prevent-scroll="true" data-testid="output_0" tabindex="-1" style="width: 1145px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="textElement eoOutputContent scrollArea" tabindex="-1" data-previous-available-width="1108" data-previous-scroll-height="666" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"> ------------------------ Scaling summary report ------------------------

 Estimation level:                             fine (scltol = 1.00)
 Name of matrix:                               S
 Size of matrix:
        * metabolites:                         68298
        * reactions:                           76664
 Stoichiometric coefficients:
        * Minimum (absolute non-zero value):   5.50e-05
        * Maximum (absolute non-zero value):   8.01e+05
 Lower bound coefficients:
        * Minimum (absolute non-zero value):   1.00e+06
        * Maximum (absolute non-zero value):   1.00e+09
 Upper bound coefficients:
        * Minimum (absolute non-zero value):   5.54e+00
        * Maximum (absolute non-zero value):   1.00e+09
 Row scaling coefficients:
        * Minimum:                             1.67e-03 (row #: 24548)
        * Maximum:                             7.90e+04 (row #: 66206)
 Column scaling coefficients:
        * Minimum:                             3.47e-04 (column #: 130)
        * Maximum:                             1.13e+04 (column #: 24943)

 ---------------------------------- Ratios --------------------------------

 Ratio of stoichiometric coefficients:         1.46e+10
 Order of magnitude diff. (stoich. coeff.):    10

 Ratio of lower bounds:                        1.00e+03
 Order of magnitude diff. (lower bounds):      3

 Ratio of upper bounds:                        1.80e+08
 Order of magnitude diff. (upper bounds):      8

 Ratio of row scaling coefficients:            4.72e+07
 Order of magnitude diff. (row scaling):       7

 Ratio of column scaling coefficients:         3.27e+07
 Order of magnitude diff. (column scaling):    7

 --------------------------------------------------------------------------

 -&gt; The model has badly scaled rows and columns. Quad precision is strongly recommended.

    Set the Quad MINOS solver with: &gt;&gt; changeCobraSolver('quadMinos', 'LP')</div></div></div></div></div><div  class = 'S8'><span>If </span><span style=' font-family: monospace;'>precisionEstimate=='quad'</span><span> then the "model has badly scaled rows and colums" then a quad precision solver is required. </span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >precisionEstimate</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsVariableStringElement" uid="EEE77773" prevent-scroll="true" data-testid="output_1" tabindex="-1" style="width: 1145px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="textElement eoOutputContent" tabindex="-1" data-previous-available-width="1108" data-previous-scroll-height="20" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="variable output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><span class="variableNameElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">precisionEstimate = </span>'quad'</div></div></div></div></div></div><div  class = 'S8'><span>Quad precision solvers come installed by default in COBRA Toolbox v3 so solverRecommendation should include  {'dqqMinos'} and   {'quadMinos'}</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >solverRecommendation</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextMatrixElement embeddedOutputsVariableMatrixElement" uid="ED7BF4F8" prevent-scroll="true" data-testid="output_2" data-width="1115" tabindex="-1" style="width: 1145px; white-space: normal; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="matrixElement veSpecifier saveLoad eoOutputContent" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="variable output " style="white-space: normal; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="veVariableName variableNameElement" style="width: 1115px; white-space: normal; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="headerElementClickToInteract" style="white-space: normal; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><span style="white-space: normal; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">solverRecommendation = </span><span class="veVariableValueSummary headerElement" style="white-space: normal; font-style: italic; color: rgb(97, 97, 97); font-size: 12px;">1×2 cell</span></div></div><div class="valueContainer" data-layout="{&quot;totalRows&quot;:1,&quot;totalColumns&quot;:2}" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="variableValue" style="width: 164px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">'dqqMinos'  'quadMinos' <br></div><div class="horizontalEllipsis hide" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><mw-icon icon-id="meatballMenuUI" icon-width="16" icon-height="16" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"></mw-icon></div><div class="verticalEllipsis hide" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><mw-icon icon-id="kebabMenuUI" icon-width="16" icon-height="16" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"></mw-icon></div></div></div><div class="outputLayer selectedOutputDecorationLayer doNotExport" aria-hidden="true" style="white-space: normal; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"></div><div class="outputLayer activeOutputDecorationLayer doNotExport" aria-hidden="true" style="white-space: normal; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"></div><div class="outputLayer scrollableOutputDecorationLayer doNotExport" aria-hidden="true" style="white-space: normal; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"></div><div class="outputLayer navigationFocusLayer doNotExport" aria-hidden="false" tabindex="-1" role="application" aria-label="variable output solverRecommendation = 1×2 cell    
'dqqMinos'  'quadMinos' 
" style="white-space: normal; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"></div></div></div></div></div><div  class = 'S8'><span>Change to a solution approach that combines double and quad precision to try to solve the LP problem.  If they are properly installed then </span><span style=' font-family: monospace;'>solverOK == 1</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >[solverOK, solverInstalled] = changeCobraSolver(</span><span style="color: #a709f5;">'dqqMinos'</span><span >,</span><span style="color: #a709f5;">'LP'</span><span >)</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="68075909" prevent-scroll="true" data-testid="output_3" tabindex="-1" style="width: 1145px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class=" textElement eoOutputContent" tabindex="-1" data-previous-available-width="1108" data-previous-scroll-height="17" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"> &gt; Solver dqqMinos is installed but not working properly.</div></div><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsVariableStringElement" uid="BC78623F" prevent-scroll="true" data-testid="output_4" tabindex="-1" style="width: 1145px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="textElement eoOutputContent" tabindex="-1" data-previous-available-width="1108" data-previous-scroll-height="35" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="variable output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><span class="variableNameElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">solverOK = <span class="headerElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">logical</span></span></div><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">   0
</div></div></div><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsVariableStringElement" uid="49029F53" prevent-scroll="true" data-testid="output_5" tabindex="-1" style="width: 1145px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="textElement eoOutputContent" tabindex="-1" data-previous-available-width="1108" data-previous-scroll-height="35" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="variable output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><span class="variableNameElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">solverInstalled = <span class="headerElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">logical</span></span></div><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">   1
</div></div></div></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%[solverOK, solverInstalled] = changeCobraSolver('quadMinos','LP')</span></span></div></div></div><div  class = 'S8'><span>Further information on numerical characterisation of COBRA models can be found in </span><span style=' font-family: monospace;'>tutorial_numCharact.mlx</span></div><h2  class = 'S1'><span>Solve a quad FBA problem</span></h2><div  class = 'S2'><span>Solve a FBA problem in quad precision using </span><span style=' font-family: monospace;'>optimizeCbModel</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #0e00ff;">if </span><span >solverOK</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    FBAsolution = optimizeCbModel(model,</span><span style="color: #a709f5;">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><h2  class = 'S1'><span>TROUBLESHOOTING</span></h2><div  class = 'S2'><span>Always check the value of </span><span style=' font-family: monospace;'>solution.stat</span><span>, which returns the status of the solution, even when using quad precision.</span></div><div  class = 'S2'><span style=' font-family: monospace;'>solution.stat == 1 </span><span> means the FBA problem is solved successfully. Anything else and there is a problem.</span></div><div  class = 'S2'><span>Although it does not happen often, there are many reasons why an FBA problem might not solve, so they are divided into three categories. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">%      solution.stat - Solver status in standardized form:</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">%                      * `-1` - No solution reported (timelimit, numerical problem etc)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">%                      * `1` - Optimal solution</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">%                      * `2` - Unbounded solution</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: #008013;">%                      * `0` - Infeasible</span></span></div></div></div><div  class = 'S8'><span style=' font-family: monospace;'>solution.stat == 0</span><span>  means that the problem is overconstrainted and no feasible flux vector v exists. The constraints need to be relaxed before the problem will solve. See tutorial_relaxedFBA.mlx</span></div><div  class = 'S2'><span style=' font-family: monospace;'>solution.stat = 2</span><span>  means that the problem is underconstrained to the extent that the possible optimal value of the objective is unbounded, that is infinity, or minus infinity. This means that extra constraints need to be added, e.g., lower and upper bounds on the reaction rates.</span></div><div  class = 'S2'><span style=' font-family: monospace;'>solution.stat = 1</span><span>  means that the problem is more complicated than either of the above. It could be that the problem does, in principle, have a solution, but that the current solver cannot find one, so an industrial quality solver should be tested, e.g., gurobi. It could also mean that the FBA problem is poorly scaled so there are numerical problems solving it, or it could also be just slightly infeasible, in which case a higher precision solver will be required to solve the problem, e.g., a quadruple precision solver. The way each solver reports the nature of the problem varies between solvers, so checking </span><span style=' font-family: monospace;'>solution.origStat</span><span> against the documentation that comes with each solver is necessary to figure out what the potential solution is.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">%    solution.stat - Solver status in standardized form:</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">%                      * `-1` - No solution reported (timelimit, numerical problem etc)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">%                      * `1` - Optimal solution</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">%                      * `2` - Unbounded solution</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: #008013;">%                      * `0` - Infeasible</span></span></div></div></div><h2  class = 'S1' id = 'H_878295C9' ><span style=' font-style: italic;'>Acknowledgments</span></h2><div  class = 'S2'><span style=' font-style: italic;'>Prof. Michael A. Saunders at Stanford University is responsible for the quad precision solvers that are included in the COBRA toolbox.</span></div><h2  class = 'S1' id = 'H_B884F0F4' ><span>REFERENCES</span></h2><div  class = 'S2'><span>[1] P. E. Gill, W. Murray, M. A. Saunders and M. H. Wright (1987). Maintaining LU factors of a general sparse matrix, Linear Algebra and its Applications 88/89, 239-270.</span></div><div  class = 'S2'><span>[2] Multiscale modeling of metabolism and macromolecular synthesis in E. coli and its application to the evolution of codon usage, Thiele et al., PLoS One, 7(9):e45635 (2012).</span></div><div  class = 'S2'><span>[3] D. Ma, L. Yang, R. M. T. Fleming, I. Thiele, B. O. Palsson and M. A. Saunders, Reliable and efficient solution of genome-scale models of Metabolism and macromolecular Expression, Scientific Reports 7, 40863; doi: \url{10.1038/srep40863} (2017). </span><a href = "http://rdcu.be/oCpn."><span>http://rdcu.be/oCpn.</span></a></div><div  class = 'S2'><span>[4]. Laurent Heirendt &amp; Sylvain Arreckx, Thomas Pfau, Sebastian N. Mendoza, Anne Richelle, Almut Heinken, Hulda S. Haraldsdottir, Jacek Wachowiak, Sarah M. Keating, Vanja Vlasov, Stefania Magnusdottir, Chiam Yu Ng, German Preciat, Alise Zagare, Siu H.J. Chan, Maike K. Aurich, Catherine M. Clancy, Jennifer Modamio, John T. Sauls, Alberto Noronha, Aarash Bordbar, Benjamin Cousins, Diana C. El Assal, Luis V. Valcarcel, Inigo Apaolaza, Susan Ghaderi, Masoud Ahookhosh, Marouen Ben Guebila, Andrejs Kostromins, Nicolas Sompairac, Hoai M. Le, Ding Ma, Yuekai Sun, Lin Wang, James T. Yurkovich, Miguel A.P. Oliveira, Phan T. Vuong, Lemmer P. El Assal, Inna Kuperstein, Andrei Zinovyev, H. Scott Hinton, William A. Bryant, Francisco J. Aragon Artacho, Francisco J. Planes, Egils Stalidzans, Alejandro Maass, Santosh Vempala, Michael Hucka, Michael A. Saunders, Costas D. Maranas, Nathan E. Lewis, Thomas Sauter, Bernhard Ø. Palsson, Ines Thiele, Ronan M.T. Fleming, </span><span style=' font-weight: bold;'>Creation and analysis of biochemical constraint-based models: the COBRA Toolbox v3.0</span><span>, Nature Protocols, volume 14, pages 639–702, 2019 </span><a href = "https://doi.org/10.1038/s41596-018-0098-2"><span>doi.org/10.1038/s41596-018-0098-2</span></a><span>.</span></div><div  class = 'S2'></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Quadruple precision Flux Balance Analysis
%% Author(s): Ronan M.T. Fleming,, Leiden University
%% Reviewer(s):
%% INTRODUCTION
% In this tutorial, Flux Balance Analysis (FBA) is introduced using the E. coli 
% core model, with functions in the COBRA Toolbox v3.0 [2].  
% 
% Flux balance analysis is a solution to the optimisation problem
% 
% $$\begin{array}{ll}\textrm{max} & c^{T}v\\\text{s.t.} & Sv=b\\ & l\leq v\leq 
% u\end{array}\end{equation}$$
% 
% where $c$ is a vector of linear objective coefficients, $S$ is an m times 
% n matrix of stoichiometric coefficients for m molecular species involved in 
% n reactions. $l\;\textrm{and}\;u\;$are n times 1 vectors that are the lower 
% and upper bounds on the n times 1 variable vector $v\;$of reaction rates (fluxes). 
% The optimal objective value is $c^{T}v^{\star}$  is always unique, but the optimal 
% vector $v^{\star}$ is usually not unique.
% 
% In summary, the data is {c,S,l,u} and the variable being optimised is v.
%% TIMING
% _< 1 hrs_
%% MATERIALS - EQUIPMENT SETUP
% Please ensure that all the required dependencies (e.g. , |git| and |curl|) 
% of The COBRA Toolbox have been properly installed by following the installation 
% guide <https://opencobra.github.io/cobratoolbox/stable/installation.html here>. 
% Please ensure that the COBRA Toolbox has been initialised (tutorial_initialize.mlx) 
% and verify that the pre-packaged LP and QP solvers are functional (tutorial_verify.mlx).
%% PROCEDURE
%% Load a multiscale model
% To load a model from a MAT-file, you can simply use the filename (with or 
% without file extension). 

if ~exist('model','var')
    load ME_matrix_GlcAer_WT.mat
    model = modelGlcOAer_WT;
    clear modelGlcOAer_WT;
end
%% _Check the scaling properties of a stoichiometric matrix_
% The scaling properties of the stoichiometric matrix using:

[precisionEstimate, solverRecommendation] = checkScaling(model);
%% 
% If |precisionEstimate=='quad'| then the "model has badly scaled rows and colums" 
% then a quad precision solver is required. 

precisionEstimate
%% 
% Quad precision solvers come installed by default in COBRA Toolbox v3 so solverRecommendation 
% should include  {'dqqMinos'} and   {'quadMinos'}

solverRecommendation
%% 
% Change to a solution approach that combines double and quad precision to try 
% to solve the LP problem.  If they are properly installed then |solverOK == 1|

[solverOK, solverInstalled] = changeCobraSolver('dqqMinos','LP')
%[solverOK, solverInstalled] = changeCobraSolver('quadMinos','LP')
%% 
% Further information on numerical characterisation of COBRA models can be found 
% in |tutorial_numCharact.mlx|
%% Solve a quad FBA problem
% Solve a FBA problem in quad precision using |optimizeCbModel|

if solverOK
    FBAsolution = optimizeCbModel(model,'max');
end
%% TROUBLESHOOTING
% Always check the value of |solution.stat|, which returns the status of the 
% solution, even when using quad precision.
% 
% |solution.stat == 1|  means the FBA problem is solved successfully. Anything 
% else and there is a problem.
% 
% Although it does not happen often, there are many reasons why an FBA problem 
% might not solve, so they are divided into three categories. 

%      solution.stat - Solver status in standardized form:
%                      * `-1` - No solution reported (timelimit, numerical problem etc)
%                      * `1` - Optimal solution
%                      * `2` - Unbounded solution
%                      * `0` - Infeasible
%% 
% |solution.stat == 0|  means that the problem is overconstrainted and no feasible 
% flux vector v exists. The constraints need to be relaxed before the problem 
% will solve. See tutorial_relaxedFBA.mlx
% 
% |solution.stat = 2|  means that the problem is underconstrained to the extent 
% that the possible optimal value of the objective is unbounded, that is infinity, 
% or minus infinity. This means that extra constraints need to be added, e.g., 
% lower and upper bounds on the reaction rates.
% 
% |solution.stat = 1|  means that the problem is more complicated than either 
% of the above. It could be that the problem does, in principle, have a solution, 
% but that the current solver cannot find one, so an industrial quality solver 
% should be tested, e.g., gurobi. It could also mean that the FBA problem is poorly 
% scaled so there are numerical problems solving it, or it could also be just 
% slightly infeasible, in which case a higher precision solver will be required 
% to solve the problem, e.g., a quadruple precision solver. The way each solver 
% reports the nature of the problem varies between solvers, so checking |solution.origStat| 
% against the documentation that comes with each solver is necessary to figure 
% out what the potential solution is.

%    solution.stat - Solver status in standardized form:
%                      * `-1` - No solution reported (timelimit, numerical problem etc)
%                      * `1` - Optimal solution
%                      * `2` - Unbounded solution
%                      * `0` - Infeasible
%% _Acknowledgments_
% _Prof. Michael A. Saunders at Stanford University is responsible for the quad 
% precision solvers that are included in the COBRA toolbox._
%% REFERENCES
% [1] P. E. Gill, W. Murray, M. A. Saunders and M. H. Wright (1987). Maintaining 
% LU factors of a general sparse matrix, Linear Algebra and its Applications 88/89, 
% 239-270.
% 
% [2] Multiscale modeling of metabolism and macromolecular synthesis in E. coli 
% and its application to the evolution of codon usage, Thiele et al., PLoS One, 
% 7(9):e45635 (2012).
% 
% [3] D. Ma, L. Yang, R. M. T. Fleming, I. Thiele, B. O. Palsson and M. A. Saunders, 
% Reliable and efficient solution of genome-scale models of Metabolism and macromolecular 
% Expression, Scientific Reports 7, 40863; doi: \url{10.1038/srep40863} (2017). 
% <http://rdcu.be/oCpn. http://rdcu.be/oCpn.>
% 
% [4]. Laurent Heirendt & Sylvain Arreckx, Thomas Pfau, Sebastian N. Mendoza, 
% Anne Richelle, Almut Heinken, Hulda S. Haraldsdottir, Jacek Wachowiak, Sarah 
% M. Keating, Vanja Vlasov, Stefania Magnusdottir, Chiam Yu Ng, German Preciat, 
% Alise Zagare, Siu H.J. Chan, Maike K. Aurich, Catherine M. Clancy, Jennifer 
% Modamio, John T. Sauls, Alberto Noronha, Aarash Bordbar, Benjamin Cousins, Diana 
% C. El Assal, Luis V. Valcarcel, Inigo Apaolaza, Susan Ghaderi, Masoud Ahookhosh, 
% Marouen Ben Guebila, Andrejs Kostromins, Nicolas Sompairac, Hoai M. Le, Ding 
% Ma, Yuekai Sun, Lin Wang, James T. Yurkovich, Miguel A.P. Oliveira, Phan T. 
% Vuong, Lemmer P. El Assal, Inna Kuperstein, Andrei Zinovyev, H. Scott Hinton, 
% William A. Bryant, Francisco J. Aragon Artacho, Francisco J. Planes, Egils Stalidzans, 
% Alejandro Maass, Santosh Vempala, Michael Hucka, Michael A. Saunders, Costas 
% D. Maranas, Nathan E. Lewis, Thomas Sauter, Bernhard Ø. Palsson, Ines Thiele, 
% Ronan M.T. Fleming, *Creation and analysis of biochemical constraint-based models: 
% the COBRA Toolbox v3.0*, Nature Protocols, volume 14, pages 639–702, 2019 <https://doi.org/10.1038/s41596-018-0098-2 
% doi.org/10.1038/s41596-018-0098-2>.
% 
%
##### SOURCE END #####
-->
</div></body></html>