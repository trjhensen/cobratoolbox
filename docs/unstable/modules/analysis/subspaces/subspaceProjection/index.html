
<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>subspaceProjection â€” The COBRA Toolbox</title>
<link href="../../../../_static/img/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"/>
<link href="../../../../_static/img/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="../../../../_static/img/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/>
<link color="#5bbad5" href="../../../../_static/img/safari-pinned-tab.svg" rel="mask-icon"/>
<link href="../../../../_static/json/manifest.json" rel="manifest"/>
<meta content="../../../../_static/browserconfig.xml" name="msapplication-config"/>
<meta content="#ffffff" name="theme-color"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="../../../../_static/js/jquery.easy-autocomplete.min.js" type="text/javascript"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet" type="text/css"/>
<link href="../../../../_static/css/easy-autocomplete.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
<link href="../../../../_static/css/cobra.css" rel="stylesheet" type="text/css">
<link href="../../../../genindex.html" rel="index" title="Index">
<link href="../../../../search.html" rel="search" title="Search">
<link href="../../../../index.html" rel="top" title="The COBRA Toolbox">
<link href="../index.html" rel="up" title="Subspaces">
<link href="../../thermo/index.html" rel="next" title="Thermo">
<link href="../rowReduce/index.html" rel="prev" title="rowReduce">
<script src="../../../../_static/js/modernizr.min.js"></script>
</link></link></link></link></link></link></link></head>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-KFJTC6J15L"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KFJTC6J15L');
</script>

<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../../../index.html"> The COBRA Toolbox
          

          
            <img alt="cobratoolbox logo" class="logo" src="http://gibbs.unal.edu.co/cobradoc/cobratoolbox/img/cobratoolbox_logo_transparent.png"/>
</a>
<h1>The COBRA Toolbox</h1>
<div role="search">
<form action="../../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input id="simple" name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
<script>
    	var options = {

		url: "../../../../_static/json/functions.json",

		getValue: "name",

		list: {
            onKeyEnterEvent: function(item) {
                    return "_static/../" + item.website_url
            },
            maxNumberOfElements: 25,
			match: {
					enabled: true,
			},
            sort: {
			    enabled: true
		    }
		},

    	template: {
	    	type: "custom",
		    method: function(value, item) {
                return "<span><a href='../../../../search.html?q=" + item.name + "&check_keywords=yes&area=default'>" + value + "</a>" + "<a href='../../../../_static/../" + item.website_url + "' ><img src='../../../../_static/link.svg'/></a></span>";
		    }
	    },

		theme: "square"

	};

	$("#simple").easyAutocomplete(options);


    </script>
</form>
</div>
</div>
<div aria-label="main navigation" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../index.html">Home</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Functions</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">Analysis</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../coupling/index.html">Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../deletion/index.html">Deletion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dynamicFBA/index.html">Dynamic FBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../exploration/index.html">Exploration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../FBA/index.html">FBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../findMIIS/index.html">findMIIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fluxEnrichmentAnalysis/index.html">fluxEnrichmentAnalysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../FVA/index.html">FVA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometricFBA/index.html">geometricFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../gMCS/index.html">gMCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../KLdistance/index.html">KLdistance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../mdFBA/index.html">mdFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../MOMA/index.html">MOMA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiSpecies/index.html">MultiSpecies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../parsimoniousFBA/index.html">parsimoniousFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../relaxedFBA/index.html">relaxedFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rFBA/index.html">rFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rMTA/index.html">rMTA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../robustnessAnalysis/index.html">robustnessAnalysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ROOM/index.html">ROOM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rumba/index.html">rumba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sampling/index.html">Sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sparseFBA/index.html">sparseFBA</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">Subspaces</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../lsqr/index.html">Lsqr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../nullspace/index.html">Nullspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../rank/index.html">Rank</a></li>
<li class="toctree-l4"><a class="reference internal" href="../rowReduce/index.html">rowReduce</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">subspaceProjection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../thermo/index.html">Thermo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../topology/index.html">Topology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../transport/index.html">Transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../uFBA/index.html">uFBA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../base/index.html">Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dataIntegration/index.html">Data integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../design/index.html">Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reconstruction/index.html">Reconstruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualization/index.html">Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cite.html">How to cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../funding.html">Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../plan.html">Development Plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contact.html">Contact</a></li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="top navigation" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../../../index.html">The COBRA Toolbox</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a class="icon icon-home" href="../../../../contents.html"></a> Â»</li>
<li><a href="../../../index.html">Functions</a> Â»</li>
<li><a href="../../index.html">Analysis</a> Â»</li>
<li><a href="../index.html">Subspaces</a> Â»</li>
<li>subspaceProjection</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="https://schema.org/Article" role="main">
<div itemprop="articleBody">
<div class="section" id="subspaceprojection">
<span id="id1"></span><h1>subspaceProjection<a class="headerlink" href="#subspaceprojection" title="Permalink to this headline">Â¶</a></h1>
<span class="target" id="module-src.analysis.subspaces.subspaceProjection"></span><dl class="function">
<dt id="src.analysis.subspaces.subspaceProjection.projectOntoSubspace">
<code class="descname">projectOntoSubspace</code><span class="sig-paren">(</span><em>A</em>, <em>vf</em>, <em>vr</em>, <em>vnet</em>, <em>u</em>, <em>u0</em>, <em>lnx</em>, <em>printLevel</em>, <em>rowBool</em>, <em>colBool</em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.subspaces.subspaceProjection.projectOntoSubspace" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Projects flux, net flux, potential and logarithmic concentration onto
their respective subspaces of A using projection matrices generated either
derived from SVD, or by using the Moore-Penrose pseudoinverse</p>
<p>Optionally, a subset of the matrix A may be chosen by using A(rowBool,colBool)
but then only the true rows of u, u0, lnx, and true columns of vf,vr,vnet are
projected and the remaining rows and columns are not affected</p>
<p>Let <cite>M</cite> denote the Moore-Penrose pseudoinverse of A and the subscripts are the following
<cite>_R</cite> row space,
<cite>_N</cite> nullspace,
<cite>_C</cite> column space,
<cite>_L</cite> left nullspace,</p>
<p>Example for flux of net flux</p>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}vf   &amp;= vf_R + vf_N \\
vf_R &amp;= M A vf = PR vf \\
vf_N &amp;= (I - M A) vf = PN vf\end{split}\]</div>
<p>Example for potential or logarithmic concentration</p>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}u   &amp;= u_C + u_L \\
u_C &amp;= A M u = PC u \\
u_L &amp;= (I - A M) u = PL u\end{split}\]</div>
<p>USAGE:</p>
<blockquote>
<div>[vfN, vfR, vrN, vrR, vnetN, vnetR, uL, uC, u0L, u0C, lnxL, lnxC] = projectOntoSubspace(modelT, vf, vr, vnet, u, u0, lnx)</div></blockquote>
<dl class="docutils">
<dt>INPUTS:</dt>
<dd>A          <cite>m x n</cite> matrix
vf:        <cite>n x 1</cite> - forward flux
vr:        <cite>n x 1</cite> - reverse flux
vnet:      <cite>n x 1</cite> - net flux
u:         <cite>m x 1</cite> - chemical potential
u0:        <cite>m x 1</cite> - standard chemical potential
lnx:       <cite>m x 1</cite> - logarithmic concentration</dd>
<dt>OPTIONAL INPUTS</dt>
<dd>rowBool    <cite>m x 1</cite> - boolean indicating the subset of rows of A
colBool    â€˜n x 1â€™ - boolean indicating the subset of cols of A</dd>
<dt>OUTPUTS:</dt>
<dd>vfN:       forward flux - nullspace
vfR:       forward flux - row space
vrN:       reverse flux - nullspace
vrR:       reverse flux - row space
vnetN:     net flux - nullspace
vnetR:     net flux - row space
uL:        chemical potential - left nullspace
uC:        chemical potential - column space
lnxL:      logarithmic concentration - left nullspace
lnxC:      logarithmic concentration - column space</dd>
</dl>
</dd></dl>
<dl class="function">
<dt id="src.analysis.subspaces.subspaceProjection.projectSVD">
<code class="descname">projectSVD</code><span class="sig-paren">(</span><em>U1</em>, <em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.subspaces.subspaceProjection.projectSVD" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Assumes that <cite>U1</cite> has orthonormal columns
so that <span class="math notranslate nohighlight">\(U1 U1^T\)</span> is a projector.
It returns the projections</p>
<div class="math notranslate nohighlight">
\[\begin{split}u1 &amp;= U1 U1^T u \\
u2 &amp;= (I - U1 U1^T) u\end{split}\]</div>
<p>USAGE:</p>
<blockquote>
<div>[u1, u2] = projectSVD(U1, u)</div></blockquote>
<p class="rubric">Example</p>
<p>[U1, D1, V1, r] = subspaceSVD(S);
[uC, uL] = projectSVD(U1, u);
[vfR, vfN] = projectSVD(V1, vf);
[vrR, vrN] = projectSVD(V1, vr);</p>
</dd></dl>
<dl class="function">
<dt id="src.analysis.subspaces.subspaceProjection.subspaceProjector">
<code class="descname">subspaceProjector</code><span class="sig-paren">(</span><em>A</em>, <em>printLevel</em>, <em>sub_space</em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.subspaces.subspaceProjection.subspaceProjector" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the matrix for projection onto the subspace of matrix A,
specified by <cite>sub_space</cite></p>
<blockquote>
<div><ul class="simple">
<li>â€˜allâ€™</li>
<li>â€˜Râ€™ row space         i.e. range(Aâ€™)</li>
<li>â€˜Nâ€™ nullspace         i.e. null(A)</li>
<li>â€˜Câ€™ column space      i.e. range(A)</li>
<li>â€˜Lâ€™ left nullspace    i.e. null(Aâ€™)</li>
</ul>
</div></blockquote>
<p>Let M denote the Moore-Penrose pseudoinverse of the A and the subscripts are the following
<cite>_R</cite> row space        i.e. range(Aâ€™)
<cite>_N</cite> nullspace        i.e. null(A)
<cite>_C</cite> column space     i.e. range(A)
<cite>_L</cite> left nullspace   i.e. null(Aâ€™)</p>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}v   &amp;= v_R + v_N \\
v_R &amp;= M A v = PR v \\
v_N &amp;= (I - M A) v = PN v\end{split}\]</div>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}u   &amp;= u_C + u_L \\
u_C &amp;= A M u = PC u \\
u_L &amp;= (I - A M) u = PL u\end{split}\]</div>
<p>Examples:</p>
<p>Given <span class="math notranslate nohighlight">\(A v = b\)</span>, then <span class="math notranslate nohighlight">\(v_R = M b\)</span></p>
<p>Given <span class="math notranslate nohighlight">\(A^Tu = q\)</span>, then <span class="math notranslate nohighlight">\(u_C = M^T q\)</span></p>
<p>USAGE:</p>
<blockquote>
<div>[PR, PN, PC, PL] = subspaceProjector(model, printLevel, sub_space)</div></blockquote>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>A          <cite>m x n</cite> matrix</dd>
<dt>OPTIONAL INPUTS:</dt>
<dd><p class="first">printLevel:          {(1), 0}, 1 = print diagnostics, 0 = silent
sub_space:           returns projection matrices onto all or one select</p>
<blockquote class="last">
<div><ul class="simple">
<li>sub_space</li>
<li>â€˜allâ€™</li>
<li>â€˜Râ€™ row space</li>
<li>â€˜Nâ€™ nullspace</li>
<li>â€˜Câ€™ column space</li>
<li>â€˜Lâ€™ left nullspace</li>
</ul>
</div></blockquote>
</dd>
<dt>OUTPUTS:</dt>
<dd><dl class="first last docutils">
<dt>[PR, PN, PC, PL]:    matrices for projection onto the row, null,</dt>
<dd>column and left nullspace of A, respectively</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="function">
<dt id="src.analysis.subspaces.subspaceProjection.subspaceSVD">
<code class="descname">subspaceSVD</code><span class="sig-paren">(</span><em>S</em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.subspaces.subspaceProjection.subspaceSVD" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns quantities satisfying <span class="math notranslate nohighlight">\(S = U1 D1 V1^T\)</span>,
where <cite>U1</cite> and <cite>V1</cite> have <cite>r</cite> orthonormal columns,
and <cite>D1</cite> is <cite>r x r</cite> diagonal and has numerical rank <cite>r</cite>.</p>
<p>The matrix <cite>S</cite> may be diagonal.
Matrices <cite>U1</cite> and <cite>V1</cite> may be used by <cite>projectSVD.m</cite>
to project given vectors onto certain subspaces.</p>
<p>USAGE:</p>
<blockquote>
<div>[U1, D1, V1, r] = subspaceSVD(S)</div></blockquote>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>S:             matrix</dd>
<dt>OUTPUTS:</dt>
<dd>U1, D1, V1:    matrices
r:             numerical rank of <cite>D1</cite></dd>
</dl>
</dd></dl>
</div>
</div>
<div class="articleComments">
</div>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a accesskey="n" class="btn btn-default float-right" href="../../thermo/index.html" rel="next" title="Thermo">Next <span class="fa fa-arrow-circle-right"></span></a>
<a accesskey="p" class="btn btn-default" href="../rowReduce/index.html" rel="prev" title="rowReduce"><span class="fa fa-arrow-circle-left"></span> Previous</a>
</div>
<hr/>
<div role="contentinfo">
<p>
        Â© Copyright 2017-2020, The COBRA Toolbox developers.

    </p>
</div>
  Built with Sphinx using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
</div>
</div>
</section>
</div>
<script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
<script src="../../../../_static/jquery.js" type="text/javascript"></script>
<script src="../../../../_static/underscore.js" type="text/javascript"></script>
<script src="../../../../_static/doctools.js" type="text/javascript"></script>
<script src="../../../../_static/language_data.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/gh/mathjax/MathJax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script src="../../../../_static/js/theme.js" type="text/javascript"></script>
<script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TRCMZL1FKK"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-TRCMZL1FKK');
  </script>
</body>
</html>